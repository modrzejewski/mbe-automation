# How to read the results

This chapter provides an overview of how to read and analyze the results generated by the `mbe-automation` workflows.

## HDF5 Datasets

The `mbe-automation` program uses the Hierarchical Data Format version 5 (HDF5) for storing large amounts of numerical data. HDF5 is a high-performance data storage format designed for flexible and efficient I/O, making it well-suited for scientific datasets.

The HDF5 file produced by a workflow contains all the raw and processed data in a hierarchical structure, similar to a file system with folders and files. This allows for organized storage and easy retrieval of specific data subsets.

## File Structure

Each workflow creates a new HDF5 file (e.g., `qha.hdf5`) and stores its results within a root group, which is named after the `root_key` parameter specified in the workflow's configuration. You can visualize the structure of the file using `mbe_automation.storage.display.tree`.

For example, a quasi-harmonic calculation will produce a file with the following structure:

```
qha.hdf5
└── quasi_harmonic
    ├── phonons
    │   └── crystal[opt:atoms,shape]
    │       ├── brillouin_zone_path
    │       └── force_constants
    ├── relaxation
    │   └── crystal[opt:atoms,shape]
    └── thermodynamics_fixed_volume
        ├── C_V_vib_crystal (J∕K∕mol∕unit cell)
        ├── E_el_crystal (kJ∕mol∕unit cell)
        └── ... (other thermodynamic properties)
```

- **`phonons`**: Group containing phonon data, including the Brillouin zone path and force constants for the relaxed crystal.
- **`relaxation`**: Group containing the relaxed crystal structure.
- **`thermodynamics_fixed_volume`**: Contains thermodynamic properties calculated at a fixed volume.

### Reading Thermodynamic Properties

The thermodynamic properties are stored as datasets that can be easily read into a `pandas` DataFrame using the `read_data_frame` function.

```python
import mbe_automation.storage.core

# Read the thermodynamic data into a pandas DataFrame
df = mbe_automation.storage.core.read_data_frame(
    dataset="qha.hdf5",
    key="quasi_harmonic/thermodynamics_fixed_volume"
)

# Display the first few rows
print(df.head())
```

This script reads all the datasets under the `quasi_harmonic/thermodynamics_fixed_volume` group and combines them into a single, well-structured DataFrame.

### Plotting Phonon Band Structure

The phonon band structure can be plotted using the specialized `band_structure` function from the `mbe_automation.dynamics.harmonic.display` module. This function reads the data and generates a complete plot.

```python
import mbe_automation.dynamics.harmonic.display

# Plot the phonon band structure and save it to a file
mbe_automation.dynamics.harmonic.display.band_structure(
    dataset="qha.hdf5",
    key="quasi_harmonic/phonons/crystal[opt:atoms,shape]/brillouin_zone_path",
    save_path="band_structure.png"
)
```
